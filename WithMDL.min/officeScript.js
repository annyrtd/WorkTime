jQuery.expr[":"].contains=function(c,d,b){return jQuery(c).text().toUpperCase().indexOf(b[3].toUpperCase())>=0};function mergeSort(d,c){var b=d.length,a=Math.floor(b/2);if(!c){c=function(f,e){if(f<e){return -1}if(f==e){return 0}else{return 1}}}if(b<2){return d}return merge(mergeSort(d.slice(0,a),c),mergeSort(d.slice(a,b),c),c)}function merge(d,b,c){var a=[];while(d.length>0||b.length>0){if(d.length>0&&b.length>0){if(c(d[0],b[0])<=0){a.push(d[0]);d=d.slice(1)}else{a.push(b[0]);b=b.slice(1)}}else{if(d.length>0){a.push(d[0]);d=d.slice(1)}else{if(b.length>0){a.push(b[0]);b=b.slice(1)}}}}return a}function CreateSearchInput_withMD(){var a=$("<input>",{type:"text","class":"mdl-textfield__input",id:"searchInput"});var c=$("<label></label>",{"class":"mdl-textfield__label","for":"searchInput",style:"line-height: 12pt !important;"}).append("Сотрудник");var b=$('<i class="material-icons" style="float: left; margin-top: 22px;">search</i>');var d=$("<div></div>",{"class":"mdl-textfield mdl-js-textfield"}).append(a,c);$("th.text").eq(0).children().hide();$("th.text").eq(0).append(b,d);componentHandler.upgradeElement($(".mdl-textfield.mdl-js-textfield").get(0));ChangeTitleToMDTooltip("searchInput","Введите фамилию <br>или имя сотрудника")}function escapeHtml(b){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return b.replace(/[&<>"']/g,function(c){return a[c]})}function SetClassesOnColumns(){var a=" header";$("th.text").first().addClass("employee header");$("col.text").first().addClass("employee");$("tbody tr").each(function(b){$(this).children("td.text").first().addClass("employee")});$("th.text").eq(1).addClass("info");$("col.text").eq(1).addClass("info");$("tbody tr").each(function(b){$(this).children("td.text").eq(1).addClass("info")});$("th.text.phone").first().addClass("first");$("col.text.phone").first().addClass("first");$("tbody tr").each(function(b){$(this).children("td.text.phone").first().addClass("first")});$("th.text.phone").eq(1).addClass("second");$("col.text.phone").eq(1).addClass("second");$("tbody tr").each(function(b){$(this).children("td.text.phone").eq(1).addClass("second")});$("th.text.phone").eq(2).addClass("third");$("col.text.phone").eq(2).addClass("third");$("tbody tr").each(function(b){$(this).children("td.text.phone").eq(2).addClass("third")});$("th.text").eq(5).addClass("workgroup header");$("col.text").eq(5).addClass("workgroup");$("tbody tr").each(function(b){$(this).children("td.text").eq(5).addClass("workgroup")});$("th.text").eq(6).addClass("room header");$("col.text").eq(6).addClass("room");$("tbody tr").each(function(b){$(this).children("td.text").eq(6).addClass("room")});$("th.indicator").first().addClass("workstate header");$("col.indicator").first().addClass("workstate");$("tbody tr").each(function(b){$(this).children("td.indicator").first().addClass("workstate")});$("th.indicator").last().addClass("mail");$("col.indicator").last().addClass("mail");$("tbody tr").each(function(b){$(this).children("td.indicator").last().addClass("mail")})}function CreateSelectForGroups(){var b=[];$("table.full-size > tbody > tr").each(function(f){var g=$(this).children("td.workgroup").text();if(b.indexOf(g)<0){b.push(g)}});b.sort();var d,e;if(IsMyHomeOffice()){d=$('<button style="float: left;" id="groupSelectButton" class="mdl-button mdl-js-button mdl-button--icon  mdl-button--accent mdl-js-ripple-effect"><i class="material-icons">group</i></button>');e=$('<div class="mdl-tooltip" for="groupSelectButton">Моя группа</div>')}var a=$("<select></select>",{id:"workgroupSelect",title:"Выберите группу"}).append("<option value=''>Группы</option>");for(var c=0;c<b.length;c++){if(b[c]!=""){a.append("<option value='"+b[c]+"'>"+b[c]+"</option>")}else{a.append("<option value='NoGroup'>---</option>")}}$("th.text").eq(5).children().hide();if(d!==undefined&&e!==undefined){$("th.text").eq(5).append(d,e,a);componentHandler.upgradeElement(d.get(0));componentHandler.upgradeElement(e.get(0))}else{$("th.text").eq(5).append(a)}}function CreateSelectOnWorkState(){var a=$("<select></select>",{id:"workStateSelect",title:"Выберите состояние"}).append("<option value=''></option>").append("<option id='option_ball_green' value='/Content/ball_green.png'>На работе</option>").append("<option id='option_ball_blue' value='/Content/ball_blue.png'>Работает удаленно</option>").append("<option id='option_ball_yellow' value='/Content/ball_yellow.png'>Закончил работу</option>").append("<option id='option_ball_gray' value='/Content/ball_gray.png'>Отсутствует</option>");$("th.indicator").eq(0).append(a)}function CreateSelectOnRoom(){var e=[];$("table.full-size > tbody > tr").each(function(f){var g=$(this).children("td.room").text();if(e.indexOf(g)<0){e.push(g)}});e.sort();var c,d;if(IsMyHomeOffice()){c=$('<button style="float: left;" id="roomSelectButton" class="mdl-button mdl-js-button mdl-button--icon  mdl-button--accent mdl-js-ripple-effect"><i class="material-icons">weekend</i></button>');d=$('<div class="mdl-tooltip" for="roomSelectButton">Моя комната</div>')}var a=$("<select></select>",{id:"roomSelect",title:"Выберите номер комнаты"}).append("<option value=''>Комната</option>");for(var b=0;b<e.length;b++){if(e[b]!=""){a.append("<option value='"+e[b]+"'>"+e[b]+"</option>")}else{a.append("<option value='NoRoom'>---</option>")}}$("th.text").eq(6).children().hide();if(c!==undefined&&d!==undefined){$("th.text").eq(6).append(c,d,a);componentHandler.upgradeElement(c.get(0));componentHandler.upgradeElement(d.get(0))}else{$("th.text").eq(6).append(a)}}function IsMyHomeOffice(){var a=GetMyName();if($('td.employee:contains("'+a+'")').length>0){return true}return false}function PrepareEmployeeColumnForSort(){var b=$("<div></div>",{"class":"arrowDiv"}).css({"float":"right",margin:"20px 0px",backgroundImage:"url("+chrome.extension.getURL("/images/bg.gif")+")"});var a=$("<div></div>",{"class":"clearfix"});$("#searchInput").css("float","left");$("#searchInput").parent().after(b,a)}function PrepareWorkgroupColumnForSort(){var b=$("<div></div>",{"class":"arrowDiv"}).css("float","right").css("backgroundImage","url("+chrome.extension.getURL("/images/bg.gif")+")");var a=$("<div></div>",{"class":"clearfix"});$("#workgroupSelect").css("float","left");$("#workgroupSelect").after(b,a)}function PrepareRoomColumnForSort(){var b=$("<div></div>",{"class":"arrowDiv"}).css("float","right").css("backgroundImage","url("+chrome.extension.getURL("/images/bg.gif")+")");var a=$("<div></div>",{"class":"clearfix"});$("#roomSelect").css("float","left");$("#roomSelect").after(b,a)}function RemoveEmptyColumns(){$("table.full-size > thead th").each(function(a){var b=true;$("table.full-size > tbody > tr").each(function(c){if($(this).children("td").eq(a).html()!=""){b=false}});if(b){$(this).hide();$("table.full-size > tbody > tr").each(function(c){$(this).children("td").eq(a).hide()})}})}function GetColumnToSort(a){if($(a).hasClass("employee")){return"employee"}if($(a).hasClass("workgroup")){return"workgroup"}if($(a).hasClass("room")){return"room"}}function AddResetFiltersButton(){var b=$('<i class="material-icons">clear</i>');var a=$("<button></button>",{id:"idReset","class":"mdl-button mdl-js-button  mdl-button--fab mdl-button--icon mdl-button--accent  mdl-js-ripple-effect",type:"button"}).append(b);var d=$("<div></div>",{"class":"buttonDiv"}).append(a).css("width","100%");$("table.full-size colgroup").append('<col class="reset button">');$("table.full-size thead tr").append('<th class="reset button"></th>');$("th.reset.button").append(d);$("table.full-size tbody tr").each(function(){$(this).append('<td class="reset button"></td>')});var c=$('<div class="mdl-tooltip" for="idReset">Сбросить<br>фильтры</div>');componentHandler.upgradeElement(c.get(0));componentHandler.upgradeElement(a.get(0));$("th.reset.button").append(c);$("button#idReset").hide()}function SetFilters(){$("table.full-size > tbody > tr").show();$("div.card-square").show();$("#searchInput").val("");$("#card-searchInput").val("");FilterGroup();FilterWorkState();FilterRoom()}function FilterGroup(){var b=$("select#workgroupSelect option").filter(":selected").val();if(b==""){return}if(b=="NoGroup"){$("td.workgroup").not("[style='display: none;']").each(function(c){if($(this).text()==""){$(this).parent().show()}else{$(this).parent().hide()}});$(".card-square").each(function(){var c=$(this).children("div.mdl-card__supporting-text").first().children("span.workgroup").first();if(c){$(this).hide()}else{$(this).show()}});return}var a='td.workgroup:contains("'+b+'")';$(a).parent().not("[style='display: none;']").show();$("td.workgroup").not(a).parent().hide();$(".card-square").not("[style='display: none;']").each(function(){if($(this).children("div.mdl-card__supporting-text").first().children("span.workgroup").first().text()!=b){$(this).hide()}})}function FilterWorkState(){var b=$("select#workStateSelect option").filter(":selected").val();if(b==""){$("select#workStateSelect").attr("title","Выберите состояние");$("th.workstate i").css("color","white").attr("title","Выберите состояние").css("textShadow","-1px 0 gray, 0 1px gray, 1px 0 gray, 0 -1px gray");return}$("tbody tr").not('[style="display: none;"]').each(function(d){if($(this).children("td.indicator").first().children("img").attr("src").indexOf(b)>-1){$(this).show()}else{$(this).hide()}});$(".card-square").not('[style="display: none;"]').each(function(d){if($(this).children("div.mdl-card__menu").first().children("img").attr("src").indexOf(b)>-1){$(this).show()}else{$(this).hide()}});var c=$("select#workStateSelect option").filter(":selected").attr("title");var a=$("select#workStateSelect option").filter(":selected").attr("id").replace("option_ball_","");switch(a){case"green":a="#8bc349";break;case"blue":a="rgb(63, 81, 181)";break;case"yellow":a="#ffeb3b";break}$("select#workStateSelect").attr("title",c);$("th.workstate i").css("color",a).attr("title",c).css("textShadow","none")}function FilterRoom(){var b=$("select#roomSelect option").filter(":selected").val();if(b==""){return}if(b=="NoRoom"){$("td.room").not('[style="display: none;"]').each(function(c){if($(this).text()==""){$(this).parent().show()}else{$(this).parent().hide()}});$(".card-square").each(function(){var c=$(this).children("div.mdl-card__supporting-text").first().children("span.room").first();if(c){$(this).hide()}else{$(this).show()}});return}var a='td.room:contains("'+b+'")';$(a).parent().not('[style="display: none;"]').show();$("td.room").not(a).parent().hide();$(".card-square").not("[style='display: none;']").each(function(){if($(this).children("div.mdl-card__supporting-text").first().children("span.room").first().text()!=b){$(this).hide()}})}function SelectHomeGroup(){$("table.full-size > tbody > tr").show();$("div.card-square").show();$("#searchInput").val("");$("#card-searchInput").val("");var b=GetMyGroupName();$("#workgroupSelect").val(b);if(b==""){return}if(b=="NoGroup"){$("td.workgroup").not('[style="display: none;"]').each(function(c){if($(this).text()==""){$(this).parent().show()}else{$(this).parent().hide()}});return}var a='td.workgroup:contains("'+b+'")';$(a).parent().not('[style="display: none;"]').show();$("td.workgroup").not(a).parent().hide();$(".card-square").each(function(){if($(this).children("div.mdl-card__supporting-text").first().children("span.workgroup").first().text()!=b){$(this).hide()}})}function GetMyGroupName(){var a="";var b=GetMyName();$("td.workgroup").each(function(c){if($(this).parent().children("td.employee").text()==b){a=$(this).text();return false}});return a}function GetMyName(){var c=$(".status-right a").text();var a=c.indexOf(" ");var d=c.substr(0,a);var b=c.substr(a+1);c=b+" "+d;return c}function SelectHomeRoom(){$("table.full-size > tbody > tr").show();$("div.card-square").show();$("#searchInput").val("");$("#card-searchInput").val("");var b=GetMyRoomNumber();$("#roomSelect").val(b);if(b==""){return}if(b=="NoRoom"){$("td.room").not('[style="display: none;"]').each(function(c){if($(this).text()==""){$(this).parent().show()}else{$(this).parent().hide()}});return}var a='td.room:contains("'+b+'")';$(a).parent().not('[style="display: none;"]').show();$("td.room").not(a).parent().hide();$(".card-square").each(function(){if($(this).children("div.mdl-card__supporting-text").first().children("span.room").first().text()!=b){$(this).hide()}})}function GetMyRoomNumber(){var a="";var b=GetMyName();$("td.room").each(function(c){if($(this).parent().children("td.employee").text()==b){a=$(this).text();return false}});return a}function CreateMDLCard(){$(".status-center").hide();$(".main").hide();var a=$("<span></span>",{"class":"mdl-layout-title"}).append($(".status-center").text());$("table.full-size").addClass("mdl-shadow--2dp");$(".mdl-layout__content").append(a,$("table.full-size"))}function ResizeTableHeader(){var a=$("table.full-size"),c=a.find("tbody tr").not("[style='display: none;']").first().children(),b;b=c.map(function(){return $(this).width()}).get();a.find("th").each(function(e,d){$(d).width(b[e])})}function CreateSettingsForLang(){$("div.mdl-layout__drawer").append($("<div id=settings></div>"));$("#settings").load("http://co-msk-app02/Preferences/Edit form",function(){$("#settings").hide();$("#settings").prepend("<br><br><label><b>Настройки:</b></label><br>");$("#ReturnTo").val("/"+window.location.search);$("#settings a").hide();$("#settings label").removeAttr("for");$("#settings label").after("<br>");$("div.table-form").last().next().css({paddingTop:"2em"});$("div.table-form").hide();$("div.table-form").first().show();ReplaceInput.apply($("form[action='/Preferences/Edit'] input[type=submit]").get(0));ChangeButtonsToMD.apply($("form[action='/Preferences/Edit'] button.inputReplaceButton").get(0));$("form[action='/Preferences/Edit'] button.inputReplaceButton").parent().css("width","0px");$("#settings").fadeIn("fast")})}function SetTableHeightForOffice(){var b=$("table.full-size tbody");var a=$(window).height()-$("header.mdl-layout__header").outerHeight(true)-$("main.mdl-layout__content.content-wide span.mdl-layout-title").outerHeight(true)-$("table.full-size thead").outerHeight(true)-$(".holiday-box").outerHeight(true)-50;b.height(a);if(b.get(0).scrollHeight<=b.get(0).clientHeight){b.css("height","auto")}}function CheckResetButton(){if($("#workgroupSelect").val()!=""||$("#workStateSelect").val()!=""||$("#roomSelect").val()!=""||$("#searchInput").val()!=""){$("button#idReset").fadeIn("fast");$("button#card-idReset").fadeIn("fast")}else{$("button#idReset").fadeOut("fast");$("button#card-idReset").fadeOut("fast")}}function AddBorderToStatusSelect(){var a=$("<span></span>").css({display:"block",border:"1px solid rgb(202, 202, 202)",paddingLeft:"3px",borderRadius:"2px"}).append($("th.indicator.workstate.header").children());$("th.indicator.workstate.header").append(a)}function AddTooltips_officeScript(){$("tbody i:contains('email')").each(function(a){if($(this).attr("title")===undefined){return true}var c="i_email_"+a;var b=$(this).attr("title");$(this).removeAttr("title");$(this).attr("id",c);ChangeTitleToMDTooltip(c,b)});$("tbody i:contains('lens')").each(function(a){if($(this).attr("title")===undefined){return true}var c="i_lens_"+a;var b=$(this).attr("title");$(this).removeAttr("title");$(this).attr("id",c);ChangeTitleToMDTooltip(c,b)});$("select").each(function(a){if($(this).attr("title")===undefined){return true}var c=$(this).attr("id");var b=$(this).attr("title");$(this).removeAttr("title");ChangeTitleToMDTooltip(c,b)});$("span.hidden-text").each(function(a){if($(this).attr("title")===undefined){return true}var c="span_hidden-text_"+a;var b=$(this).attr("title");$(this).removeAttr("title");$(this).attr("id",c);ChangeTitleToMDTooltip(c,b)})}function ResetTableParametres(){$(".card-square").show();$("table.full-size > tbody > tr").show();$("#workgroupSelect, #workStateSelect, #roomSelect").val("");$("#searchInput").val("").parent().removeClass("is-dirty");$("#card-searchInput").val("").parent().removeClass("is-dirty");$("th.workstate i").css("color","white").css("textShadow","-1px 0 gray, 0 1px gray, 1px 0 gray, 0 -1px gray")}function AddToggleButtonTableAndCards(){var b=$('<i id="table-icon" class="material-icons">list</i>');var a=$('<i id="card-icon" class="material-icons">apps</i>');var f=$("<button></button>",{id:"table-button","class":"mdl-button mdl-js-button mdl-button--icon mdl-button--accent mdl-button--fab mdl-js-ripple-effect"}).append(b);var d=$("<button></button>",{id:"card-button","class":"mdl-button mdl-js-button mdl-button--icon mdl-button--accent mdl-js-ripple-effect"}).append(a);var g=$('<div id="toggle-div" class="toggle"></div>').append(f,d);$("main > span.mdl-layout-title").css({display:"flex",alignItems:"center",height:"65px"}).append(g);var e=$('<div id="toggle-tooltip" class="mdl-tooltip" for="table-button">Отображать <br>таблицей</div>');var c=$('<div id="toggle-tooltip" class="mdl-tooltip" for="card-button">Отображать <br>карточками</div>');componentHandler.upgradeElement(f.get(0));componentHandler.upgradeElement(d.get(0));componentHandler.upgradeElement(e.get(0));componentHandler.upgradeElement(c.get(0));g.append(e,c)}function SetWorkerCards(){var c=$("<div></div>",{"class":"card-box"});var b;var a=$("table.full-size tbody tr").each(function(d){b=getMDLCard($(this),d);c.append(b)});$("table.full-size").after(c);c.hide();$("div.card-box div.mdl-tooltip").each(function(){var f=$(this).attr("for");var e=$(this).text();var d=!$(this).parent().hasClass("mdl-card__supporting-text");$(this).remove();ChangeTitleToMDTooltip(f,e,(d?"mdl-tooltip--left":""))})}function getMDLCard(b,h){var t=$('<div id="person-image'+h+'" class="circular" ></div><br><br>');var k=$('<h2 class="mdl-card__title-text"></h2>').css({alignSelf:"flex-start"}).append(b.children("td.text.employee").html());var p=b.children("td.indicator.workstate").children("i").first().css("color").replace("rgb","rgba");p=p.substr(0,p.length-1);p+=",0.5)";var u=$("<div></div>",{"class":"mdl-card__title mdl-card--expand"}).css({backgroundColor:p,flexDirection:"column"}).append(t,k);var f=b.children("td.text.workgroup").text();var s=b.children("td.text.room").text();var r=b.children("td.text.info").first();var i=b.children("td.text.phone.first").text();var e=b.children("td.text.phone.second").text();var q=b.children("td.text.phone.third").text();var d=$("<div></div>",{"class":"mdl-card__supporting-text"}).append(f?'<span class="bold workgroup">'+f+"</span><br>":"<br>").append(s?'<span class="room">'+s+"</span><br><br>":"<br><br>").append(r?r.html()+"<br><br>":"<br><br>").append(i?'Tел.: <span class="phone first">'+i+"</span><br>":"<br>").append(e?'Моб.тел.: <span class="phone second">'+e+"</span><br>":"<br>").append(q?'Дом.тел.: <span class="phone third">'+q+"</span><br>":"<br>");var c=$("<div></div>",{"class":"mdl-card__menu"}).append(b.children("td.indicator.workstate").html()).append(b.children("td.indicator.mail").html());var o="card-"+c.children("i").first().attr("id");var m=c.children("div.mdl-tooltip").first();var j=c.children("i").first();j.attr("id",o);m.attr("for",o);m.removeAttr("data-upgraded");var n="card-"+c.children("a").first().children("i").first().attr("id");var l=c.children("a").first().children("div.mdl-tooltip").first();var g=c.children("a").first().children("i").first();g.attr("id",n);l.attr("for",n);l.removeAttr("data-upgraded");if(r.children("span.hidden-text").length>0){r.children("span.hidden-text").each(function(){var w="card-"+$(this).attr("id");var v=r.children("div.mdl-tooltip[for="+$(this).attr("id")+"]").first();$(this).attr("id",w);v.attr("for",w);v.removeAttr("data-upgraded")})}var a=$("<div></div>",{"class":"card-square mdl-card mdl-shadow--2dp"}).css({order:h}).append(u,d,c);return a}function AddSortingMenuForCards(){var h=$("<div></div>",{"class":"card-sorting-menu toggle"});var g,b;var f,a;if(IsMyHomeOffice()){g=$('<button style="float: left;" id="card-groupSelectButton" class="mdl-button mdl-js-button mdl-button--icon  mdl-button--accent mdl-js-ripple-effect"><i class="material-icons">group</i></button>');b=$('<div class="mdl-tooltip" for="card-groupSelectButton">Моя группа</div>');f=$('<button style="float: left;" id="card-roomSelectButton" class="mdl-button mdl-js-button mdl-button--icon  mdl-button--accent mdl-js-ripple-effect"><i class="material-icons">weekend</i></button>');a=$('<div class="mdl-tooltip" for="card-roomSelectButton">Моя комната</div>')}var e=$('<i class="material-icons">clear</i>');var d=$("<button></button>",{id:"card-idReset","class":"mdl-button mdl-js-button  mdl-button--fab mdl-button--icon mdl-button--accent  mdl-js-ripple-effect",type:"button"}).append(e);var c=$('<div class="mdl-tooltip" for="card-idReset">Сбросить<br>фильтры</div>');$("#toggle-div").after(h);CreateCardSearchInput();if(g!==undefined&&b!==undefined&&$("div.card-square span.workgroup").length>0){h.append(g,b);componentHandler.upgradeElement(g.get(0));componentHandler.upgradeElement(b.get(0))}if(f!==undefined&&a!==undefined&&$("div.card-square span.room").length>0){h.append(f,a);componentHandler.upgradeElement(f.get(0));componentHandler.upgradeElement(a.get(0))}h.append(d,c);componentHandler.upgradeElement(d.get(0));componentHandler.upgradeElement(c.get(0));d.hide();h.hide()}function CreateCardSearchInput(){var a=$("<input>",{type:"text","class":"mdl-textfield__input",id:"card-searchInput"});var d=$("<label></label>",{"class":"mdl-textfield__label","for":"card-searchInput",style:"line-height: 12pt !important;"}).append("Сотрудник");var c=$('<i class="material-icons" style="float: left; margin-top: 22px;">search</i>');var e=$("<div></div>",{"class":"mdl-textfield mdl-js-textfield"}).append(a,d);var b=$("<div class='toggle'></div>").append(c,e);$("div.card-sorting-menu").append(b);componentHandler.upgradeElement(e.get(0));ChangeTitleToMDTooltip("card-searchInput","Введите фамилию <br>или имя сотрудника")}function FilterPeople(e){var b="td.employee";var d=b+':contains("'+e+'")';$(d).parent().show();$(b).not(d).parent().hide();$("th.workstate i").css("color","white").css("textShadow","-1px 0 gray, 0 1px gray, 1px 0 gray, 0 -1px gray");var a="div.card-square > div.mdl-card__title > h2.mdl-card__title-text";var c=a+':contains("'+e+'")';$(c).parent().parent().show();$(a).not(c).parent().parent().hide()}function SetProfileImages(){var b=new Date();var a=b.getDate();if(a%7==0&&!localStorage.isCleared){localStorage.clear();localStorage.isCleared=true}else{localStorage.isCleared=false}$("div.card-square").each(function(){var c=$(this);var d=c.children("div.mdl-card__menu").first().children('a[href^="mailto:"]').first().attr("href").replace("mailto:","");if(d){if(localStorage[d]){var e=localStorage[d];if(e){c.children("div.mdl-card__title").first().children("div.circular").first().css({background:'url("'+e+'") no-repeat',backgroundSize:"cover"})}}else{$.get("http://confirmitconnect.firmglobal.com/Search/Pages/PeopleResults.aspx?k="+d,{},function(h,f,k){var j=h.replace(/\/(_layouts|Style)+/g,"http://confirmitconnect.firmglobal.com/$1").replace("IMNRC","String.prototype.toLowerCase");var g=$("<div></div>");g.html(j);var i=g.find("#CSR_IMG_1").attr("src");if(i){localStorage[d]=i;c.children("div.mdl-card__title").first().children("div.circular").first().css({background:'url("'+i+'") no-repeat',backgroundSize:"cover"})}})}}})}$(document).ready(function(){CreateSearchInput_withMD();SetClassesOnColumns();CreateSelectForGroups();CreateSelectOnWorkState();CreateSelectOnRoom();PrepareEmployeeColumnForSort();PrepareWorkgroupColumnForSort();PrepareRoomColumnForSort();RemoveEmptyColumns();AddResetFiltersButton();CreateSettingsForLang();CreateMDLCard();AddBorderToStatusSelect();AddTooltips_officeScript();$("button").not("#idReset").not(".mdl-button--icon").not("form[action='/Remote/Come'] button, form[action='/Remote/Leave'] button").each(function(a){ChangeButtonsToMD.apply(this)});$("table.full-size").before($("div.holiday-box"));ShowTableFullSizeAndHolidayBox();ResizeTableHeader();SetTableHeightForOffice();AddToggleButtonTableAndCards();SetWorkerCards();AddSortingMenuForCards();SetProfileImages();$("#searchInput").on("propertychange input change keyup paste click",function(){$("#workgroupSelect, #workStateSelect, #roomSelect").val("");var a=escapeHtml($(this).val());$("#card-searchInput").val(a);FilterPeople(a);if(a!=""){$(this).parent().addClass("is-dirty");$("#card-searchInput").parent().addClass("is-dirty")}else{$(this).parent().removeClass("is-dirty");$("#card-searchInput").parent().removeClass("is-dirty")}ResizeTableHeader();SetTableHeightForOffice();CheckResetButton()});$("#workgroupSelect, #workStateSelect, #roomSelect").change(function(){SetFilters();ResizeTableHeader();SetTableHeightForOffice();CheckResetButton()});$(".arrowDiv").click(function(){var b=GetColumnToSort($(this).parent());var a=$("table.full-size > tbody > tr");if($(this).hasClass("headerSortUp")){a=mergeSort(a,function(d,c){if($(d).children("td."+b).text().toLowerCase()>$(c).children("td."+b).text().toLowerCase()){return -1}else{if($(d).children("td."+b).text().toLowerCase()<$(c).children("td."+b).text().toLowerCase()){return 1}else{return 0}}});$(this).removeClass("headerSortUp").addClass("headerSortDown").css("backgroundImage","url("+chrome.extension.getURL("/images/asc.gif")+")")}else{a=mergeSort(a,function(d,c){if($(d).children("td."+b).text()>$(c).children("td."+b).text()){return 1}else{if($(d).children("td."+b).text()<$(c).children("td."+b).text()){return -1}else{return 0}}});$(this).removeClass("headerSortDown").addClass("headerSortUp").css("backgroundImage","url("+chrome.extension.getURL("/images/desc.gif")+")")}$("table.full-size > tbody").append(a)});$("button#idReset").on("click",function(){ResetTableParametres();ResizeTableHeader();SetTableHeightForOffice();$(this).fadeOut("fast");$("button#card-idReset").fadeOut("fast")});$("#roomSelectButton").click(function(){ResetTableParametres();SelectHomeRoom();ResizeTableHeader();SetTableHeightForOffice();CheckResetButton()});$("#groupSelectButton").click(function(){ResetTableParametres();SelectHomeGroup();ResizeTableHeader();SetTableHeightForOffice();CheckResetButton()});$(window).resize(function(){ResizeTableHeader();SetTableHeightForOffice()}).resize();$("#table-button").click(function(){var a="mdl-button--fab";if($(this).hasClass(a)){return}$(this).addClass(a);$("#card-button").removeClass(a);$("table.full-size").show();$("div.card-box").hide();$("div.card-sorting-menu").hide();ResizeTableHeader();SetTableHeightForOffice()});$("#card-button").click(function(){var a="mdl-button--fab";if($(this).hasClass(a)){return}$(this).addClass(a);$("#table-button").removeClass(a);$("div.card-box").show();$("div.card-sorting-menu").show();$("table.full-size").hide()});$("#card-groupSelectButton").click(function(){ResetTableParametres();SelectHomeGroup();CheckResetButton()});$("button#card-idReset").on("click",function(){ResetTableParametres();$(this).fadeOut("fast");$("button#idReset").fadeOut("fast")});$("#card-searchInput").on("propertychange input change keyup paste click",function(){$("#workgroupSelect, #workStateSelect, #roomSelect").val("");var a=escapeHtml($(this).val());$("#searchInput").val(a);FilterPeople(a);if(a!=""){$(this).parent().addClass("is-dirty");$("#searchInput").parent().addClass("is-dirty")}else{$(this).parent().removeClass("is-dirty");$("#searchInput").parent().removeClass("is-dirty")}CheckResetButton()})});